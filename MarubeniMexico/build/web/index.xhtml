<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html
    PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:p="http://primefaces.org/ui" xmlns:jsf="http://xmlns.jcp.org/jsf">
    <h:head>
        <title>Login</title>

        <link href="resources/css/index.css" rel="stylesheet" type="text/css" />

        <meta name="viewport" content="width=device-width, initial-scale=1.0"></meta>
    </h:head>

    <body>
        <h:form id="frmMsg">
            <section class="hero news alternate">
                <div class="grid-container">
                    <div class="cell">
                        <div class="annotation">SISTEMA DE GASTOS
                            Release 25.03.10</div>
                        <h1>Marubeni México</h1>
                    </div>
                </div>
            </section>

        </h:form>



        <h:form id="formLogin" class="modal-content logo-name"
                style="text-align: center">
            <p:blockUI block="formLogin" trigger="token" widgetVar="buiDatatable">
                <img src="resources/imagenes/send.gif" style="width: 120px; height: 120px;" alt=""/>
            </p:blockUI>
            <p:growl id="mensaje" showSummary="true" life="50000"
                     showDetail="true" />
            <p:growl id="mensajeGral" sticky="true" showDetail="true" life="3000" />


            <div class="imgcontainer">

                <img src="resources/imagenes/login.png" alt="Login" class="avatar" />
                <br></br> <br></br> <label for="uname"><b>USUARIO</b></label> <br></br>
                <input id="usuario" type="text" name="uname" jsf:value="#{loginBean.usuario.nombre}"
                       placeholder="Ingresa tu usuario" required="true" label="username" 
                       jsf:requiredMessage="REQUIERE USUARIO" jsf:label="REQUIERE USUARIO" />
                <label for="psw"><b>CONTRASEÑA</b></label> <input id="password" type="password" 
                                                                  name="psw" placeholder="Ingresa tu contraseña"
                                                                  jsf:value="#{loginBean.usuario.clave}" required="true"
                                                                  jsf:label="REQUIERE CONTRASEÑA" label="password"
                                                                  jsf:requiredMessage="REQUIERE PASSWORD" />
                <p:commandButton id="token" value="Login"
                                 actionListener="#{loginBean.validarPrimerIngreso()}" update="formLogin"
                                 style="height: 40px; width: 160px;  font-size: 16px;"/>

                <p:dialog id="dlgToken" widgetVar="dlgTokenUsr" modal="false"  showHeader="true"
                          resizable="false" header="Ingresa tu token" width="500px" height="300px"
                          showEffect="size" hideEffect="puff" closable="false"
                          minimizable="false">
  
                        <p:inputText id="mitoken" style="width: 160px !important" value="#{loginBean.usuario.token}" 
                                     placeholder="Ingresa Token" autocomplete="off"
                                     onkeyup="javascript:this.value = this.value.toUpperCase();"/>
                        <br></br>
                        <p:commandButton id="inicio"
                                         update="formLogin:mensaje"
                                         style="height: 40px; width: 160px;"
                                         value="Iniciar sesión" 
                                         actionListener="#{loginBean.login()}"
                                         >

                        </p:commandButton>
             
                        <br></br>
                        
                </p:dialog>
            </div>

            <script
                src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.11.3/gsap.min.js"
                integrity="sha512-gmwBmiTVER57N3jYS3LinA9eb8aHrJua5iQD7yqYCKa5x6Jjc7VDVaEA0je0Lu0bP9j7tEjV3+1qUm6loO99Kw=="
            crossorigin="anonymous" referrerpolicy="no-referrer"></script>



        </h:form>

        <script type="text/javascript">
                                         function handleLoginRequest(xhr, status, args) {
                                             if (args.validationFailed || !args.loggedIn) {
                                                 jQuery('#formLogin').jq.effect("shake", {times: 1}, 100);
                                             } else {
                                                 location.href = args.ruta;
                                             }
                                         }
        </script>

    </body>

</html>